from cryptography.fernet import Fernet

def load_key():
    file=open("key.key","rb")
    key=file.read()
    file.close()
    return key

master_pwd=input("What is the master Password? ")
key=load_key() + master_pwd.encode()   #encode()takes ur string and convert it into bytes 
fer=Fernet(key)

'''
def write_key():  #this is all just for encryption 
    key=Fernet.generate_key()
    with open("key.key","wb")as key_file:
        key_file.write(key)'''

def view():
    with open('password.txt','r')as f:
        for line in f.readlines():
            data=line.rstrip()    #line.rstrip() it will strip off the space 
            user, passw = data.split("|")    
            print("User:", user,"|Password:",fer.decrypt(passw.encode()).decode())

#b'hello' this is a bytes string     

def add():
    name=input("Account name: ")
    pwd=input("Password: ")

#'a' adds something at the end of the existing file.
    with open('password.txt','a')as f:    #with closes the file itself after we are done
        f.write(name + "|" + fer.encrypt(pwd.encode()).decode() + "\n" )  #f=open('password.txt','a')can also be used but we have to manually close it later;file.close()
#fer.,,,, to store the encrypted password
#decode()converts the byte to normal string 

while True:
    mode=input("Would you like to add a password or view exisiting ones? (view/add), press q to quit. ").lower()
    if mode=="q":
        break
    if mode=="view":
        view()
    elif mode=="add":
        add()
    else:
        print("Invalid mode.")
        continue 